<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ngTable Examples</title>

    <!--[if lt IE 9]>
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <![endif]-->
    <script src="bower_components/angular/angular.min.js"></script>
    <script src="bower_components/ng-table/dist/ng-table.min.js"></script>

    <link rel="stylesheet" href="bower_components/ng-table/dist/ng-table.min.css">
</head>
<body ng-app="main">

<div class="row">
    <div class="col-md-9">

        <div class="pull-right padded">
            <div class="btn-group">
                <button type="button" ng-class="{'active': tabState == 'example'}" ng-click="tabState = 'example'" class="btn btn-default">Example</button>
                <button type="button" ng-class="{'active': tabState == 'code'}" ng-click="tabState = 'code'" class="btn btn-default">Code</button>
            </div>
        </div>
        <div class="padded">
            <div ng-show="tabState == 'code'">
                <pre data-prettycode="exampleCode"></pre>
            </div>
            <div ng-show="tabState == 'example'" ng-view></div>
        </div>

    </div>

    </div>
</div>

<script>
    var app = angular.module('main', ['ngRoute', 'ngResource', 'ngSocial', 'ngTable', 'ngTableExport'])
            .config(['$routeProvider',
                function($routeProvider) {
                    var getTemplatePath = function($routeParams) {
                        return 'views/demo' + $routeParams.id + '.html';
                    }
                    $routeProvider.
                            when('/', {
                                templateUrl: 'views/intro.html',
                                controller: function($rootScope, $routeParams, $http) {
                                    $rootScope.tabState = 'example';

                                    var url = 'views/intro.html';
                                    $http.get(url).success(function(res) {
                                        $rootScope.exampleCode = res;
                                    });
                                }
                            }).
                            when('/demo/:id', {
                                templateUrl: function($routeParams) {
                                    return getTemplatePath($routeParams);
                                },
                                controller: function($rootScope, $routeParams, $http) {
                                    $rootScope.tabState = 'example';

                                    var url = getTemplatePath($routeParams);
                                    $http.get(url).success(function(res) {
                                        $rootScope.exampleCode = res;
                                    });
                                }
                            });
                }])
            .factory('IssueService', ['$resource', function($resource) {
                return $resource('https://api.github.com/repos/:username/:repo/issues', {
                    state: 'open'
                }, {
                    query: {
                        method: 'GET',
                        isArray: true
                    }
                });
            }])
            .run(['$rootScope', function($rootScope) {
                $rootScope.tabState = 'example';
            }])
            .directive('runScript', function(){
                return {
                    restrict: 'A',
                    link: function(scope, element, attrs){
                        with(window) {
                            eval(element.html()); // just for demo, don't use in real projects
                        }
                    }
                }
            })
            .directive('prettycode', function() {
                return {
                    restrict: 'A',
                    scope: {
                        'code': '=prettycode',
                        'prettyLang': '@prettyLang'
                    },
                    link: function postLink(scope, element, attrs) {
                        scope.$watch('code', function(code) {
                            if (angular.isUndefined(code)) {
                                return;
                            }
                            element.html(hljs.highlight(scope.prettyLang || 'html', code).value);
                        })
                        element.html(hljs.highlight(scope.prettyLang || 'html', element.text()).value);
                    }
                };
            });
</script>

</body>
</html>